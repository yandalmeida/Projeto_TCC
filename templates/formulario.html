{% extends "base.html" %}

{% block title %}Formulário Pesquisa Cantina{% endblock %}

{% block content %}
<h1 class="text-2xl font-bold text-center mb-6 text-green-700">Formulário de Pesquisa</h1>

<form method="POST" class="bg-white rounded-lg shadow-md p-6 max-w-lg mx-auto space-y-6">
  <div>
    <label for="nome" class="block font-semibold mb-1">Nome:</label>
    <input type="text" id="nome" name="nome" required
           class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-600" />
  </div>

  <div>
    <label for="frequencia_visita" class="block font-semibold mb-1">Com que frequência você frequenta a cantina?</label>
    <select id="frequencia_visita" name="frequencia_visita" required
            class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-600">
      <option value="" disabled hidden>Selecione</option>
      <option>Diariamente</option>
      <option>Semanalmente</option>
      <option>Mensalmente</option>
      <option>Raramente</option>
    </select>
  </div>

  <div>
    <label for="prefere_opcao_vegana" class="block font-semibold mb-1">Você prefere opções veganas/vegetarianas?</label>
    <select id="prefere_opcao_vegana" name="prefere_opcao_vegana" required
            class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-600">
      <option value="" disabled hidden>Selecione</option>
      <option>Sim</option>
      <option>Não</option>
    </select>
  </div>

  <div>
    <p class="block font-semibold mb-1">Você tem alergias alimentares?</p>
    <div class="flex space-x-4">
      <label for="alergia_sim">
        <input type="radio" id="alergia_sim" name="tem_alergia" value="Sim" required> Sim
      </label>
      <label for="alergia_nao">
        <input type="radio" id="alergia_nao" name="tem_alergia" value="Não" required> Não
      </label>
    </div>
  </div>

  <div id="alergia-detalhes" style="display:none;">
    <label for="quais_alergias" class="block font-semibold mb-1">Quais alergias?</label>
    <input type="text" id="quais_alergias" name="quais_alergias"
           class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-600" />
  </div>

  <div>
    <label for="satisfacao_geral" class="block font-semibold mb-1">De 1 a 5, como você avalia a satisfação geral com a cantina?</label>
    <select id="satisfacao_geral" name="satisfacao_geral" required
            class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:ring-2 focus:ring-green-600">
      <option value="" disabled hidden>Selecione</option>
      <option value="1">1 - Muito insatisfeito</option>
      <option value="2">2 - Insatisfeito</option>
      <option value="3">3 - Neutro</option>
      <option value="4">4 - Satisfeito</option>
      <option value="5">5 - Muito satisfeito</option>
    </select>
  </div>

  <button type="submit"
          class="w-full bg-green-600 hover:bg-green-800 text-white font-semibold py-3 rounded transition shadow">
    Enviar
  </button>
</form>
{% endblock %}

{% block scripts %}
<script>
  function toggleAllergyDetails() {
    const temAlergia = document.querySelector('input[name="tem_alergia"]:checked')?.value;
    const divDetalhes = document.getElementById('alergia-detalhes');
    divDetalhes.style.display = temAlergia === 'Sim' ? 'block' : 'none';
  }

  document.addEventListener('DOMContentLoaded', () => {
    toggleAllergyDetails();
    document.querySelectorAll('input[name="tem_alergia"]').forEach(el => {
      el.addEventListener('change', toggleAllergyDetails);
    });
  });
</script>
{% endblock %}
